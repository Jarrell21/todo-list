(()=>{"use strict";const e=(e,t,o)=>{const s=()=>e,n=()=>t,c=()=>o;return{getTitle:s,setTitle:t=>{e=t},getDate:n,setDate:e=>{t=e},getStatus:c,setStatus:e=>{o=e},toJSON:()=>({title:s(),dueDate:n(),status:c()}),getDateFormatted:()=>{const e=t.split("-")[0];return`${t.split("-")[1]}/${t.split("-")[2]}/${e}`}}},t=e=>{const t=()=>e;let o=[];const s=()=>o;return{toJSON:()=>({projectName:t(),tasks:s()}),setTasks:e=>{o=e},getName:t,setName:t=>{e=t},getTasks:s,getTask:e=>o.find((t=>t.getTitle()===e)),addTask:e=>{o.push(e)},deleteTask:e=>{o=o.filter((t=>t.getTitle()!==e))}}},o={getTodoList:()=>{const o=Object.assign((()=>{let e=[];e.push(t("Home")),e.push(t("Today")),e.push(t("This week"));const o=()=>e;return{toJSON:()=>({projects:o()}),getProjects:o,getProject:t=>e.find((e=>e.getName()===t)),addProject:t=>{e.push(t)},setProjects:t=>{e=t},deleteProject:t=>{e=e.filter((e=>e.getName()!==t))}}})(),JSON.parse(localStorage.getItem("todoList")));return null!==localStorage.getItem("todoList")?(o.setProjects(o.projects.map((e=>Object.assign(t(),e)))),o.getProjects().forEach((e=>e.setName(e.projectName))),o.getProjects().forEach((t=>{t.setTasks(t.tasks.map((t=>Object.assign(e(),t))))})),o.getProjects().forEach((e=>{e.getTasks().forEach((e=>{e.setTitle(e.title),e.setDate(e.dueDate),e.setStatus(e.status)}))}))):(o.setProjects(o.getProjects().map((e=>Object.assign(t(),e)))),o.getProjects().forEach((t=>t.setTasks(t.getTasks().map((t=>Object.assign(e(),t))))))),o},saveTodoList:e=>{localStorage.setItem("todoList",JSON.stringify(e))},addTask:(e,t)=>{const s=o.getTodoList();s.getProject(e).addTask(t),o.saveTodoList(s)},addProject:e=>{const t=o.getTodoList();t.addProject(e),o.saveTodoList(t)},renameTask:(e,t,s)=>{const n=o.getTodoList();n.getProject(e).getTask(t).setName(s),o.saveTodoList(n)},changeTaskStatus:(e,t,s)=>{const n=o.getTodoList();n.getProject(e).getTask(t).setStatus(s),o.saveTodoList(n)},deleteProject:e=>{const t=o.getTodoList();t.deleteProject(e),o.saveTodoList(t)},deleteTask:(e,t)=>{const s=o.getTodoList();s.getProject(e).deleteTask(t),o.saveTodoList(s)}},s=o,n={loadHomePage:()=>{n.loadProjects(),n.initAddProjectButtons(),n.openProject("Home",document.getElementById("home-btn"))},loadProjects:()=>{s.getTodoList().getProjects().forEach((e=>{"Home"!==e.getName()&&"Today"!==e.getName()&&"This week"!==e.getName()&&n.createNewProject(e.getName())})),n.initProjectButtons()},loadProjectContent:e=>{document.querySelector("#content").innerHTML=`\n        <div id="content-title">${e}</div>\n        <div id="content-body">\n          <div class="tasks-list"></div>\n        </div>`;const t=document.querySelector("#content-body");"Today"!==e&&"This week"!==e&&(t.innerHTML+='\n                <button class="add-task-btn">\n                  Add Task\n                </button>\n                <div class="task-popup" style="display: none">\n                  <input placeholder="Title" class="task-popup-title">\n                  <input type="date" class="task-popup-date">\n                  <div class="task-popup-btns">\n                    <button class="task-popup-add-btn">\n                      ADD\n                    </button>\n                    <button class="task-popup-cancel-btn">\n                      CANCEL\n                    </button>\n                  </div>\n                </div>'),n.loadTasks(e)},loadHomeTasks:e=>{n.openProject("Home",e.currentTarget)},loadTodayTasks:e=>{n.openProject("Today",e.currentTarget)},loadThisWeekTasks:e=>{n.openProject("This week",e.currentTarget)},createNewProject:e=>{document.querySelector(".projects-list").innerHTML+=`\n    <div class="project">\n      <button class="project-btn">\n        <span>${e}</span>\n        <span class="project-delete-btn">x</span>\n      </button>\n      \n    </div>\n    `,n.initProjectButtons()},openProject:(e,t)=>{const o=document.querySelectorAll("button");n.loadProjectContent(e),o.forEach((e=>{e.classList.remove("active")})),t.classList.add("active")},addProject:()=>{const e=document.querySelector(".project-popup-input").value,o=t(e);s.addProject(o),n.createNewProject(o.getName()),n.closeProjectPopup()},deleteProject:(e,t)=>{t.classList.contains("active")&&n.clearProjectContent(),s.deleteProject(e),n.clearProjects(),n.loadProjects()},clearProjects:()=>{document.querySelector(".projects-list").textContent=""},clearProjectContent:()=>{document.querySelector("#content").textContent=""},openProjectPopup:()=>{const e=document.querySelector(".add-project-btn"),t=document.querySelector(".project-popup");e.style.display="none",t.style.display="flex"},closeProjectPopup:()=>{const e=document.querySelector(".add-project-btn"),t=document.querySelector(".project-popup"),o=document.querySelector(".project-popup-input");e.style.display="block",t.style.display="none",o.value=""},loadTasks:e=>{s.getTodoList().getProject(e).getTasks().forEach((e=>{n.createNewTask(e)})),"Today"!==e&&"This week"!==e&&n.initAddTaskButtons()},createNewTask:e=>{const t=document.querySelector(".tasks-list"),o=document.querySelector("#content-title").textContent,c=s.getTodoList().getProject(o).getTask(e.getTitle()).getStatus(),a=document.createElement("div");a.classList.add("task"),"ongoing"===c?(a.classList.remove("completed"),a.innerHTML+='<input type="checkbox" class="task-checkbox">'):(a.classList.add("completed"),a.innerHTML+='<input type="checkbox" class="task-checkbox" checked>'),a.innerHTML+=`\n        <p>${e.getTitle()}</p>\n        <p>${e.getDateFormatted()}</p>\n        <button class="edit-task-btn">Edit</button>\n        <button class="delete-task-btn">Delete</button>\n      `,t.appendChild(a),n.initTaskButtons()},addTask:()=>{const t=document.querySelector("#content-title").textContent,o=document.querySelector(".task-popup-title").value,c=document.querySelector(".task-popup-date").value,a=e(o,c,"ongoing");""!==o&&""!==c?(s.addTask(t,a),n.closeTaskPopup(),n.createNewTask(a)):alert("Fields must be complete")},editTask:e=>{const t=e.target.parentNode.children[1].textContent;e.target.parentNode.children[2].textContent,console.log(t)},deleteTask:e=>{const t=document.querySelector("#content-title").textContent,o=e.target.parentNode.children[1].textContent;s.deleteTask(t,o),n.clearTasks(),n.loadTasks(t)},changeTaskStatus:e=>{const t=document.querySelector("#content-title").textContent,o=e.target.parentNode,n=o.children[1].textContent;e.target.checked?(o.classList.add("completed"),s.changeTaskStatus(t,n,"completed")):(o.classList.remove("completed"),s.changeTaskStatus(t,n,"ongoing"))},clearTasks:()=>{document.querySelector(".tasks-list").textContent=""},openTaskPopup:()=>{const e=document.querySelector(".add-task-btn"),t=document.querySelector(".task-popup");e.style.display="none",t.style.display="flex"},closeTaskPopup:()=>{const e=document.querySelector(".add-task-btn"),t=document.querySelector(".task-popup"),o=document.querySelectorAll(".task-popup>input");e.style.display="block",t.style.display="none",o.forEach((e=>e.value=null))},initAddTaskButtons:()=>{const e=document.querySelector(".add-task-btn"),t=document.querySelector(".task-popup-add-btn"),o=document.querySelector(".task-popup-cancel-btn");e.addEventListener("click",n.openTaskPopup),t.addEventListener("click",n.addTask),o.addEventListener("click",n.closeTaskPopup)},initAddProjectButtons:()=>{const e=document.querySelector(".add-project-btn"),t=document.querySelector(".project-popup-add-btn"),o=document.querySelector(".project-popup-cancel-btn");e.addEventListener("click",n.openProjectPopup),t.addEventListener("click",n.addProject),o.addEventListener("click",n.closeProjectPopup)},initProjectButtons:()=>{const e=document.querySelector("#home-btn"),t=document.querySelector("#today-btn"),o=document.querySelector("#this-week-btn"),s=document.querySelectorAll(".project-btn");e.addEventListener("click",n.loadHomeTasks),t.addEventListener("click",n.loadTodayTasks),o.addEventListener("click",n.loadThisWeekTasks),s.forEach((e=>{e.addEventListener("click",n.handleProjectButtons)}))},initTaskButtons:()=>{const e=document.querySelectorAll(".task-checkbox"),t=document.querySelectorAll(".edit-task-btn"),o=document.querySelectorAll(".delete-task-btn");e.forEach((e=>{e.addEventListener("change",n.changeTaskStatus)})),t.forEach((e=>{e.addEventListener("click",n.editTask)})),o.forEach((e=>{e.addEventListener("click",n.deleteTask)}))},handleProjectButtons:e=>{const t=e.currentTarget,o=t.children[0].textContent;e.target.classList.contains("project-delete-btn")?n.deleteProject(o,t):n.openProject(o,t)}},c=n;document.addEventListener("DOMContentLoaded",c.loadHomePage)})();